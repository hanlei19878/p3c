<?xml version="1.0" encoding="UTF-8"?>
<test-data xmlns="http://pmd.sourceforge.net/rule-tests"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://pmd.sourceforge.net/rule-tests https://pmd.sourceforge.io/rule-tests_1_0_0.xsd">
    <code-fragment id="TestMyBatisRule"><![CDATA[
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dcits.ensemble.dbmanage.dao.MbAcctDao">
    <!-- Created by furongb on 2015/12/09 14:58:10. -->
    <sql id="Base_Column_List">
            ACCOUNTING_STATUS,ACCOUNTING_STATUS_PREV,ACCOUNT_STATUS_UPD_DATE,ACCT_CLASS,ACCT_CLOSE_DATE,ACCT_CLOSE_REASON,
            ACCT_CLOSE_USER_ID,ACCT_DESC,ACCT_DUE_DATE,ACCT_EXEC,ACCT_LICENSE_DATE,ACCT_LICENSE_NO,ACCT_NAME,ACCT_NATURE,
            ACCT_OPEN_DATE,ACCT_REAL_FLAG,ACCT_SEQ_NO,ACCT_STATUS,ACCT_STATUS_PREV,ACCT_STATUS_UPD_DATE,ACCT_STOP_PAY,
            ACCT_TYPE,ACCT_VERIFICATION_IND,ADDTL_PRINCIPAL,ALL_DEP_IND,ALL_DRA_IND,ALT_ACCT_NAME,APPLY_BRANCH,APPROVAL_DATE,
            APPROVAL_STATUS,APPR_LETTER_NO,APPR_USER_ID,AUTO_RENEW_ROLLOVER,AUTO_SETTLE,BAL_TYPE,BASE_ACCT_NO,BRANCH,
            BUSINESS_UNIT,CARD_NO,CCY,CLIENT_NO,CLIENT_TYPE,CMISLOAN_NO,COMPANY,CUR_STAGE_NO,DAC_VALUE,DORMANT_DATE,
            EFFECT_DATE,FIVE_CATEGORY,FIXED_CALL,GL_TYPE,HOME_BRANCH,INTERNAL_KEY,INT_IND,LAST_CHANGE_DATE,LAST_CHANGE_USER_ID,
            LAST_MVMT_STATUS,LAST_TRAN_DATE,LEAD_ACCT_FLAG,LENDER,MAIN_BAL_FLAG,MAIN_INT_FLAG,MATURITY_DATE,MM_REF_NO,
            MULTI_BAL_TYPE,NOTICE_PERIOD,OLD_PROD_TYPE,OPEN_TRAN_DATE,ORIG_ACCT_OPEN_DATE,ORI_MATURITY_DATE,OSA_FLAG,
            OWNERSHIP_TYPE,PARENT_INTERNAL_KEY,PARTIAL_RENEW_ROLL,PROD_TYPE,PROFIT_CENTRE,REASON_CODE,REGEN_SCHEDULE,
            REGION_FLAG,RENEW_NO,ROLLOVER_NO,ROUTER_KEY,SCHED_MODE,SETTLE,SETTLE_DATE,SETTLE_USER_ID,SOURCE_MODULE,
            SOURCE_TYPE,SUB_PROJECT_NO,SUB_SCHED_MODE,TERM,TERMINAL_ID,TERM_TYPE,TIMES_RENEWED,TIMES_ROLLEDOVER,
            TRAN_TIME,TRAN_TIMESTAMP,USER_ID,XRATE,XRATE_ID,PRE_SPLIT_CYCLE,RELATED_PARTY
     </sql>
    <sql id="MBA_List">
        ma.ACCOUNTING_STATUS,ma.ACCOUNTING_STATUS_PREV,ma.ACCOUNT_STATUS_UPD_DATE,ma.ACCT_CLASS,ma.ACCT_CLOSE_DATE,
        ma.ACCT_CLOSE_REASON,ma.ACCT_CLOSE_USER_ID,ma.ACCT_DESC,ma.ACCT_DUE_DATE,ma.ACCT_EXEC,ma.ACCT_LICENSE_DATE,
        ma.ACCT_LICENSE_NO,ma.ACCT_NAME,ma.ACCT_NATURE,ma.ACCT_OPEN_DATE,ma.ACCT_REAL_FLAG,ma.ACCT_SEQ_NO,ma.ACCT_STATUS,
        ma.ACCT_STATUS_PREV,ma.ACCT_STATUS_UPD_DATE,ma.ACCT_STOP_PAY,ma.ACCT_TYPE,ma.ACCT_VERIFICATION_IND,ma.ADDTL_PRINCIPAL,
        ma.ALL_DEP_IND,ma.ALL_DRA_IND,ma.ALT_ACCT_NAME,ma.APPLY_BRANCH,ma.APPROVAL_DATE,ma.APPROVAL_STATUS,ma.APPR_LETTER_NO,
        ma.APPR_USER_ID,ma.AUTO_RENEW_ROLLOVER,ma.AUTO_SETTLE,ma.BAL_TYPE,ma.BASE_ACCT_NO,ma.BRANCH,ma.BUSINESS_UNIT,ma.CARD_NO,
        ma.CCY,ma.CLIENT_NO,ma.CLIENT_TYPE,ma.CMISLOAN_NO,ma.COMPANY,ma.CUR_STAGE_NO,ma.DAC_VALUE,ma.DORMANT_DATE,ma.EFFECT_DATE,
        ma.FIVE_CATEGORY,ma.FIXED_CALL,ma.GL_TYPE,ma.HOME_BRANCH,ma.INTERNAL_KEY,ma.INT_IND,ma.LAST_CHANGE_DATE,
        ma.LAST_CHANGE_USER_ID,ma.LAST_MVMT_STATUS,ma.LAST_TRAN_DATE,ma.LEAD_ACCT_FLAG,ma.LENDER,ma.MAIN_BAL_FLAG,
        ma.MAIN_INT_FLAG,ma.MATURITY_DATE,ma.MM_REF_NO,ma.MULTI_BAL_TYPE,ma.NOTICE_PERIOD,ma.OLD_PROD_TYPE,ma.OPEN_TRAN_DATE,
        ma.ORIG_ACCT_OPEN_DATE,ma.ORI_MATURITY_DATE,ma.OSA_FLAG,ma.OWNERSHIP_TYPE,ma.PARENT_INTERNAL_KEY,ma.PARTIAL_RENEW_ROLL,
        ma.PROD_TYPE,ma.PROFIT_CENTRE,ma.REASON_CODE,ma.REGEN_SCHEDULE,ma.REGION_FLAG,ma.RENEW_NO,ma.ROLLOVER_NO,ma.ROUTER_KEY,
        ma.SCHED_MODE,ma.SETTLE,ma.SETTLE_DATE,ma.SETTLE_USER_ID,ma.SOURCE_MODULE,ma.SOURCE_TYPE,ma.SUB_PROJECT_NO,
        ma.SUB_SCHED_MODE,ma.TERM,ma.TERMINAL_ID,ma.TERM_TYPE,ma.TIMES_RENEWED,ma.TIMES_ROLLEDOVER,ma.TRAN_TIME,
        ma.TRAN_TIMESTAMP,ma.USER_ID,ma.XRATE,ma.XRATE_ID,ma.PRE_SPLIT_CYCLE,ma.RELATED_PARTY
     </sql>
    <sql id="MAC_List">
        ROWNUM as rno ,mac.INTERNAL_KEY, mac.BASE_ACCT_NO, mac.PROD_TYPE, mac.CCY, mac.ACCT_SEQ_NO, mac.CARD_NO, mac.BRANCH, mac.CLIENT_NO, mac.PROFIT_CENTRE,
        mac.ACCT_OPEN_DATE, mac.EFFECT_DATE, mac.OPEN_TRAN_DATE, mac.ACCT_STATUS, mac.ACCT_STATUS_PREV, mac.ACCT_STATUS_UPD_DATE, mac.ACCOUNTING_STATUS,
        mac.ACCOUNTING_STATUS_PREV, mac.ACCOUNT_STATUS_UPD_DATE, mac.ACCT_NAME, mac.ALT_ACCT_NAME, mac.ACCT_DESC, mac.ACCT_NATURE, mac.OWNERSHIP_TYPE, mac.ACCT_EXEC,
        mac.ACCT_CLOSE_DATE, mac.ACCT_CLOSE_REASON, mac.ACCT_CLOSE_USER_ID, mac.ALL_DEP_IND, mac.ALL_DRA_IND, mac.ACCT_DUE_DATE, mac.ACCT_LICENSE_NO, mac.ACCT_LICENSE_DATE,
        mac.PARENT_INTERNAL_KEY, mac.LEAD_ACCT_FLAG, mac.MULTI_BAL_TYPE, mac.BAL_TYPE, mac.OSA_FLAG, mac.REGION_FLAG, mac.APPR_LETTER_NO, mac.TERM, mac.TERM_TYPE, mac.MATURITY_DATE,
        mac.APPLY_BRANCH, mac.HOME_BRANCH, mac.TERMINAL_ID, mac.USER_ID, mac.LAST_CHANGE_USER_ID, mac.LAST_CHANGE_DATE, mac.TIMES_RENEWED, mac.TIMES_ROLLEDOVER, mac.RENEW_NO,
        mac.ROLLOVER_NO, mac.PARTIAL_RENEW_ROLL, mac.ADDTL_PRINCIPAL, mac.LAST_MVMT_STATUS, mac.NOTICE_PERIOD, mac.ORIG_ACCT_OPEN_DATE, mac.ORI_MATURITY_DATE, mac.ACCT_VERIFICATION_IND,
        mac.LENDER, mac.SUB_PROJECT_NO, mac.FIVE_CATEGORY, mac.DAC_VALUE, mac.COMPANY, mac.CMISLOAN_NO, mac.XRATE, mac.XRATE_ID, mac.REASON_CODE, mac.MM_REF_NO, mac.SETTLE, mac.SETTLE_USER_ID,
        mac.SETTLE_DATE, mac.APPROVAL_STATUS, mac.APPR_USER_ID, mac.APPROVAL_DATE, mac.SCHED_MODE, mac.SOURCE_TYPE, mac.SOURCE_MODULE, mac.BUSINESS_UNIT, mac.CLIENT_TYPE, mac.AUTO_SETTLE,
        mac.INT_IND, mac.MAIN_BAL_FLAG, mac.MAIN_INT_FLAG, mac.ACCT_REAL_FLAG, mac.SUB_SCHED_MODE, mac.CUR_STAGE_NO, mac.GL_TYPE, mac.ACCT_CLASS, mac.ACCT_TYPE, mac.FIXED_CALL, mac.LAST_TRAN_DATE,
        mac.DORMANT_DATE, mac.ACCT_STOP_PAY, mac.REGEN_SCHEDULE, mac.OLD_PROD_TYPE, mac.TRAN_TIMESTAMP, mac.TRAN_TIME, mac.ROUTER_KEY, mac.IS_CHECKED, mac.AUTO_RENEW_ROLLOVER, mac.PRE_SPLIT_CYCLE,mac.RELATED_PARTY
    </sql>
    <select id="selectByPrimaryKey" parameterType="com.dcits.ensemble.dbmanage.dbmodel.MbAcct"
            resultType="com.dcits.ensemble.dbmanage.dbmodel.MbAcct">
        select *
        from MB_ACCT
        where INTERNAL_KEY = #{internalKey,jdbcType=DECIMAL}
    </select>

    <select id="getAcctRealFlag" parameterType="java.util.Map" resultType="com.dcits.ensemble.dbmanage.dbmodel.MbAcct" >
        select count(*)
        from MB_ACCT
        where 1=1
        <if test="baseAcctNo != null and baseAcctNo !=''">
            AND BASE_ACCT_NO = #{baseAcctNo,jdbcType=VARCHAR}
        </if>
        <if test="prodType != null and prodType !=''">
            and PROD_TYPE = #{prodType,jdbcType=VARCHAR}
        </if>
        <if test="acctSeqNo != null and acctSeqNo !=''">
            and ACCT_SEQ_NO = #{acctSeqNo,jdbcType=VARCHAR}
        </if>
    </select>
    <select id="queryMbAcctNum" parameterType="java.util.Map"
            resultType="com.dcits.ensemble.dbmanage.dbmodel.MbAcct">
        select distinct base_acct_no
        from mb_acct
        WHERE CLIENT_NO = #{clientNo,jdbcType=VARCHAR}
        AND acct_status != 'C'
        AND  acct_type = 'C'
        AND  acct_class = '1'
    </select>
    <delete id="deleteByPrimaryKey" parameterType="com.dcits.ensemble.dbmanage.dbmodel.MbAcct">
        delete from MB_ACCT
        where INTERNAL_KEY = #{internalKey,jdbcType=DECIMAL}
    </delete>


    <select id="getMbAcctSelective" parameterType="java.util.Map"
            resultType="com.dcits.ensemble.dbmanage.dbmodel.MbAcct">
        SELECT
        *
        FROM mb_acct
        WHERE base_acct_no =#{baseAcctNo,jdbcType=VARCHAR}
        <if test="statusFlag==null or statusFlag==''">
            AND acct_status != 'C'
        </if>
        <if test="acctType != null and acctType !=''">
            AND acct_type = #{acctType,jdbcType=VARCHAR}
        </if>
        <if test="prodType != null and prodType !=''">
            AND prod_type = #{prodType,jdbcType=VARCHAR}
        </if>
        <if test="ccy != null and ccy !=''">
            AND ccy = #{ccy,jdbcType=VARCHAR}
        </if>
        <if test="acctSeqNo != null and acctSeqNo !=''">
            AND ACCT_SEQ_NO = #{acctSeqNo,jdbcType=VARCHAR}
        </if>
        ORDER BY base_acct_no,ACCT_SEQ_NO ASC
    </select>

    <select id="getAllMbAcctSelect" parameterType="java.util.Map"
            resultType="com.dcits.ensemble.dbmanage.dbmodel.MbAcct">
        SELECT
        <include refid="Base_Column_List"/>
        FROM mb_acct
        WHERE base_acct_no =#{baseAcctNo,jdbcType=VARCHAR}
        <if test="prodType != null and prodType !=''">
            AND prod_type = #{prodType,jdbcType=VARCHAR}
        </if>
        <if test="ccy != null and ccy !=''">
            AND ccy = #{ccy,jdbcType=VARCHAR}
        </if>
        <if test="acctSeqNo != null and acctSeqNo !=''">
            AND ACCT_SEQ_NO = #{acctSeqNo,jdbcType=VARCHAR}
        </if>
        ORDER BY base_acct_no,ACCT_SEQ_NO+0 ASC
    </select>

    <select id="getMbAcctSelective1" parameterType="java.util.Map"
            resultType="com.dcits.ensemble.dbmanage.dbmodel.MbAcct">
        SELECT
        <include refid="Base_Column_List"/>
        FROM mb_acct
        WHERE base_acct_no =#{baseAcctNo,jdbcType=VARCHAR}
        <if test="prodType != null and prodType !=''">
            AND prod_type = #{prodType,jdbcType=VARCHAR}
        </if>
        <if test="ccy != null and ccy !=''">
            AND ccy = #{ccy,jdbcType=VARCHAR}
        </if>
        <if test="acctSeqNo != null and acctSeqNo !=''">
            AND ACCT_SEQ_NO = #{acctSeqNo,jdbcType=VARCHAR}
        </if>
        ORDER BY base_acct_no,ACCT_SEQ_NO ASC
    </select>
    <select id="getMbAcctAllByBaseAcctNo" parameterType="java.util.Map"
            resultType="com.dcits.ensemble.dbmanage.dbmodel.MbAcct">
        SELECT
        <include refid="Base_Column_List"/>
        FROM mb_acct
        WHERE base_acct_no =#{baseAcctNo,jdbcType=VARCHAR}
        <if test="prodType != null and prodType !=''">
            AND prod_type = #{prodType,jdbcType=VARCHAR}
        </if>
        <if test="ccy != null and ccy !=''">
            AND ccy = #{ccy,jdbcType=VARCHAR}
        </if>
        <if test="acctSeqNo != null and acctSeqNo !=''">
            AND ACCT_SEQ_NO = #{acctSeqNo,jdbcType=VARCHAR}
        </if>
        ORDER BY base_acct_no,ACCT_SEQ_NO ASC
    </select>

    <select id="getMbAcctForType" parameterType="java.util.Map"
            resultType="com.dcits.ensemble.dbmanage.dbmodel.MbAcct" fetchSize="5000">
        SELECT
        <include refid="Base_Column_List"/>
        FROM mb_acct
        WHERE acct_status != 'C'
        AND BRANCH =#{branch,jdbcType=VARCHAR}
        <if test="prodType != null and prodType !=''">
            AND prod_type = #{prodType,jdbcType=VARCHAR}
        </if>
        <if test="acctName != null and acctName !=''">
            AND ACCT_NAME LIKE '%${acctName}%'
        </if>
        <if test="baseAcctNo != null and baseAcctNo !=''">
            AND BASE_ACCT_NO = #{baseAcctNo,jdbcType=VARCHAR}
        </if>
        ORDER BY base_acct_no
    </select>

    <select id="getMbAcctSelectiveByPage" parameterType="com.dcits.galaxy.dal.mybatis.proactor.page.ParameterWrapper"
            resultType="com.dcits.ensemble.dbmanage.dbmodel.MbAcct">
        SELECT
        <include refid="Base_Column_List"/>
        FROM mb_acct
        WHERE base_acct_no =#{baseParam.baseAcctNo,jdbcType=VARCHAR}
        <if test="statusFlag==null or statusFlag==''">
            AND acct_status != 'C'
        </if>
        <if test="baseParam.prodType != null and baseParam.prodType !=''">
            AND prod_type = #{baseParam.prodType,jdbcType=VARCHAR}
        </if>
        <if test="baseParam.ccy != null and baseParam.ccy !=''">
            AND ccy = #{baseParam.ccy,jdbcType=VARCHAR}
        </if>
        <if test="baseParam.acctSeqNo != null and baseParam.acctSeqNo !=''">
            AND ACCT_SEQ_NO = #{baseParam.acctSeqNo,jdbcType=VARCHAR}
        </if>
        ORDER BY base_acct_no,ACCT_SEQ_NO ASC
    </select>
    <select id="getCancelMbAcct" parameterType="java.util.Map"
            resultType="com.dcits.ensemble.dbmanage.dbmodel.MbAcct">
        SELECT
        <include refid="Base_Column_List"/>
        FROM mb_acct
        WHERE  base_acct_no =#{baseAcctNo,jdbcType=VARCHAR}
        AND (ACCT_STATUS != 'C' or (ACCT_STATUS = 'C'
        and ACCT_CLOSE_DATE = #{runDate,jdbcType=VARCHAR}))
        <if test="prodType != null and prodType !=''">
            AND prod_type = #{prodType,jdbcType=VARCHAR}
        </if>
        <if test="ccy != null and ccy !=''">
            AND ccy = #{ccy,jdbcType=VARCHAR}
        </if>
        <if test="acctSeqNo != null and acctSeqNo !=''">
            AND ACCT_SEQ_NO = #{acctSeqNo,jdbcType=VARCHAR}
        </if>
        ORDER BY base_acct_no,ACCT_SEQ_NO+0 ASC
    </select>
    <select id="getAutoSettleAcctsTSplit" parameterType="java.util.Map"
            resultType="com.dcits.ensemble.dbmanage.dbmodel.MbAcct">
        SELECT
        <include refid="MBA_List"/>
        FROM mb_acct ma,mb_acct_attach b
        WHERE ma.internal_key between #{START_KEY} and #{END_KEY}
        and ma.internal_key = b.internal_key
        and ma.MATURITY_DATE = #{runDate,jdbcType=VARCHAR}
        and ma.ACCT_STATUS != 'C' and b.AUTO_SETTLE_FLAG ='Y'
        ORDER BY ma.internal_key+0 ASC
    </select>

    <select id="getMbLeadAcctByBaseAcctNo1" parameterType="java.util.Map"
            resultType="com.dcits.ensemble.dbmanage.dbmodel.MbAcct">
        SELECT
        <include refid="Base_Column_List"/>
        FROM mb_acct
        WHERE base_acct_no = #{baseAcctNo,jdbcType=VARCHAR}
        and lead_acct_flag = 'Y'
        ORDER BY ACCT_SEQ_NO ASC
    </select>

    <select id="getMbRbAcctByBaseAcctNo" parameterType="java.util.Map"
            resultType="com.dcits.ensemble.dbmanage.dbmodel.MbAcct">
        SELECT
        <include refid="Base_Column_List"/>
        FROM mb_acct
        WHERE acct_status != 'C'
        and base_acct_no = #{baseAcctNo,jdbcType=VARCHAR}
        and lead_acct_flag = 'N'
        AND source_module = 'RB'
        ORDER BY ACCT_SEQ_NO ASC
    </select>

    <select id="getCancelMbLeadAcctByBaseAcctNo" parameterType="java.util.Map"
            resultType="com.dcits.ensemble.dbmanage.dbmodel.MbAcct">
        SELECT
        <include refid="Base_Column_List"/>
        FROM mb_acct
        WHERE (ACCT_STATUS != 'C' or (ACCT_STATUS = 'C'
        and ACCT_CLOSE_DATE = #{runDate,jdbcType=VARCHAR}))
        and base_acct_no = #{baseAcctNo,jdbcType=VARCHAR}
        and lead_acct_flag = 'Y'
        ORDER BY ACCT_SEQ_NO ASC
    </select>
    <select id="getCancelMbLeadAcctByBaseAcctNo1" parameterType="java.util.Map"
            resultType="com.dcits.ensemble.dbmanage.dbmodel.MbAcct">
        SELECT
        <include refid="Base_Column_List"/>
        FROM mb_acct
        WHERE ACCT_STATUS != 'C'
        and base_acct_no = #{baseAcctNo,jdbcType=VARCHAR}
        and lead_acct_flag = 'Y'
        ORDER BY ACCT_SEQ_NO ASC
    </select>

    <select id="getMbAcctByBaseAcctNo" parameterType="java.util.Map"
            resultType="com.dcits.ensemble.dbmanage.dbmodel.MbAcct">
        SELECT
        <include refid="Base_Column_List"/>
        FROM mb_acct
        WHERE acct_status != 'C'
        and base_acct_no = #{baseAcctNo,jdbcType=VARCHAR}
        ORDER BY ACCT_SEQ_NO ASC
    </select>

    <select id="getMbAcctByBaseAcctNoAndGlCode" parameterType="java.util.Map"
            resultType="com.dcits.ensemble.dbmanage.dbmodel.MbAcct">
        SELECT
        <include refid="MBA_List"/>
        FROM MB_ACCT ma
        LEFT JOIN MB_ACCT_ATTACH B
        ON ma.INTERNAL_KEY = B.INTERNAL_KEY
        WHERE ma.BRANCH = #{branchId,jdbcType=VARCHAR}
        AND B.GL_CODE = #{glCode,jdbcType=VARCHAR}
        <if test="baseAcctNo!=null and baseAcctNo.length() > 0">
            AND ma.BASE_ACCT_NO = #{baseAcctNo,jdbcType=VARCHAR}
        </if>
        <if test="statusFlag==null or statusFlag==''">
            AND acct_status != 'C'
        </if>
        ORDER BY ma.ACCT_SEQ_NO ASC
    </select>

    <select id="getCancelMbAcctByBaseAcctNoAndGlCode" parameterType="java.util.Map"
            resultType="com.dcits.ensemble.dbmanage.dbmodel.MbAcct">
        SELECT
        <include refid="MBA_List"/>
        FROM MB_ACCT ma
        LEFT JOIN MB_ACCT_ATTACH B
        ON ma.INTERNAL_KEY = B.INTERNAL_KEY
        WHERE (ACCT_STATUS != 'C' or (ACCT_STATUS = 'C'
        and ACCT_CLOSE_DATE = #{runDate,jdbcType=VARCHAR}))
        AND ma.BRANCH = #{branchId,jdbcType=VARCHAR}
        <if test="baseAcctNo != null and baseAcctNo.length() > 0">
            AND ma.BASE_ACCT_NO = #{baseAcctNo,jdbcType=VARCHAR}
        </if>
        <if test="glCode != null and glCode.length() > 0">
            AND B.GL_CODE = #{glCode,jdbcType=VARCHAR}
        </if>
        ORDER BY ma.ACCT_SEQ_NO ASC
    </select>

    <select id="getMbAcctByBaseAcctNoor" parameterType="java.util.Map"
            resultType="com.dcits.ensemble.dbmanage.dbmodel.MbAcct">
        SELECT
        <include refid="Base_Column_List"/>
        FROM mb_acct
        WHERE BASE_ACCT_NO=#{baseAcctNo,jdbcType=VARCHAR}
        AND lead_acct_flag != 'Y'
        <if test="acctSeqNo!=null and acctSeqNo.length()> 0">
            AND ACCT_SEQ_NO=#{acctSeqNo,jdbcType=VARCHAR}
        </if>
        ORDER BY ACCT_SEQ_NO ASC
    </select>

    <select id="getClientNo" parameterType="java.util.Map" resultType="java.lang.String">
        SELECT client_no
        FROM mb_acct
        WHERE base_acct_no = #{baseAcctNo}
        <if test="acctStatus!=null and acctStatus.length()> 0">
            AND acct_status !='C'
        </if>
        ORDER BY ACCT_SEQ_NO ASC
    </select>

    <select id="getLinkValue" parameterType="java.util.Map" resultType="java.lang.String">
        SELECT   INTERNAL_KEY
        FROM mb_acct
        WHERE base_acct_no = #{baseAcctNo,jdbcType=VARCHAR}
    </select>

    <select id="getAllMbAcctByClientNo" parameterType="java.util.Map"
            resultType="com.dcits.ensemble.dbmanage.dbmodel.MbAcct">
        SELECT
        <include refid="Base_Column_List"/>
        FROM mb_acct
        WHERE SOURCE_MODULE = 'RB'
        and acct_status != 'C'
        and client_no = #{clientNo}
        <if test="leadAcctFlag != null and leadAcctFlag.length() > 0">
            and LEAD_ACCT_FLAG = #{leadAcctFlag,jdbcType=VARCHAR}
        </if>
        ORDER BY ACCT_SEQ_NO ASC
    </select>

    <select id="getAllMbAcctByClientNoJustice" parameterType="java.util.Map"
            resultType="com.dcits.ensemble.dbmanage.dbmodel.MbAcct">
        SELECT
        <include refid="Base_Column_List"/>
        FROM mb_acct
        WHERE SOURCE_MODULE = 'RB'
        and CLIENT_NO = #{clientNo}
        AND ACCT_REAL_FLAG !='N'
        AND  PROD_TYPE NOT IN (select PROD_TYPE
        from batch_mb_prod_define
        where PROD_TYPE IN (SELECT PROD_TYPE FROM MB_ACCT WHERE SOURCE_MODULE = 'RB' and client_no = #{clientNo})
        and ATTR_KEY = 'AGREEMENT_TYPE'
        and STATUS='A'
        and PROD_TYPE NOT IN('02010208'))
        ORDER BY ACCT_SEQ_NO ASC
    </select>

    <select id="getMbAcctByClientNo" parameterType="java.util.Map"
            resultType="com.dcits.ensemble.dbmanage.dbmodel.MbAcct">
        SELECT
        <include refid="Base_Column_List"/>
        FROM mb_acct
        WHERE SOURCE_MODULE = 'RB'
        <if test="leadAcctFlag != null and leadAcctFlag.length() > 0">
            and LEAD_ACCT_FLAG = #{leadAcctFlag,jdbcType=VARCHAR}
        </if>
        <if test="acctStatus != null and acctStatus.length() > 0">
            and acct_status != #{acctStatus,jdbcType=VARCHAR}
        </if>
        and client_no = #{clientNo}
        ORDER BY internal_key ASC
    </select>

    <select id="getMbAcctByClientNoByPage" parameterType="com.dcits.galaxy.dal.mybatis.proactor.page.ParameterWrapper"
            resultType="com.dcits.ensemble.dbmanage.dbmodel.MbAcct">
        SELECT
        <include refid="Base_Column_List"/>
        FROM mb_acct
        WHERE SOURCE_MODULE = 'RB'
        and client_no = #{baseParam.clientNo}
        <if test="baseParam.leadAcctFlag != null and baseParam.leadAcctFlag.length() > 0">
            and LEAD_ACCT_FLAG = #{baseParam.leadAcctFlag,jdbcType=VARCHAR}
        </if>
        <if test="baseParam.acctStatus != null and baseParam.acctStatus.length() > 0">
            and acct_status != #{baseParam.acctStatus,jdbcType=VARCHAR}
        </if>
        ORDER BY internal_key ASC
    </select>

    <select id="getAutoMbAcctListSplit" parameterType="java.util.Map" resultType="java.util.Map">
        <if test="_databaseId == 'oracle'">
            SELECT MIN (internal_key) START_KEY, MAX (internal_key) END_KEY ,COUNT(1) ROW_COUNT
            FROM (SELECT DISTINCT a.internal_key
            FROM mb_acct a,mb_acct_attach b
            WHERE a.internal_key = b.internal_key
            AND a.MATURITY_DATE = #{runDate,jdbcType=VARCHAR}
        AND a.ACCT_STATUS != 'C'
        AND b.AUTO_SETTLE_FLAG ='Y'
        order by internal_key+0 ASC)
        GROUP BY TRUNC ((ROWNUM-1) / #{maxPerCount})
        ORDER BY START_KEY
        </if>
        <if test="_databaseId == 'mysql'">
        SELECT
        MIN( key_field ) START_KEY,
        MAX( key_field ) END_KEY,
        count( 1 ) ROW_COUNT
        FROM
        (
        SELECT
        key_field,
        @rownum := @rownum + 1 AS rownum
        FROM
        (
        SELECT DISTINCT
        a.internal_key key_field
        FROM
        mb_acct a,
        mb_acct_attach b
        WHERE
        a.internal_key = b.internal_key
        AND a.MATURITY_DATE = #{runDate,jdbcType=VARCHAR}
        AND a.ACCT_STATUS != 'C'
        AND b.AUTO_SETTLE_FLAG = 'Y'
        ) t1,
        ( SELECT @rownum := - 1 ) t
        ORDER BY
        key_field
        ) tt
        GROUP BY
        FLOOR( tt.rownum / #{maxPerCount} )
    </if>
</select>

        </mapper>
    ]]>
    </code-fragment>

    <test-code>
        <description>TEST</description>
        <expected-problems>2</expected-problems>
        <expected-linenumbers>50,86</expected-linenumbers>
        <code-ref id="TestMyBatisRule" />
    </test-code>

    <code-fragment id="TestMyBatisRule2"><![CDATA[
<?xml version="1.0" encoding="UTF-8"?><a></a>
    ]]>
    </code-fragment>

    <test-code>
        <description>TEST2</description>
        <expected-problems>0</expected-problems>
        <!--        <expected-linenumbers>3,4,7,13</expected-linenumbers>-->
        <code-ref id="TestMyBatisRule2" />
    </test-code>
</test-data>